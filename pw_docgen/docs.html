

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pw_docgen &mdash; Pigweed</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pw_doctor" href="../pw_doctor/docs.html" />
    <link rel="prev" title="pw_cpu_exception_armv7m" href="../pw_cpu_exception_armv7m/docs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Pigweed
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pigweed.googlesource.com/pigweed/pigweed/+/refs/heads/master">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pigweed-review.googlesource.com">Code Reviews</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/pigweed">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.gg/M9NSeTA">Chat Room</a></li>
<li class="toctree-l1"><a class="reference external" href="https://bugs.chromium.org/p/pigweed/issues/list">Issue Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/embedded_cpp_guide.html">Embedded C++ Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/style_guide.html">Code Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../targets.html">Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build_system.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/module_structure.html">Module Structure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../module_guides.html">Module Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../docker/docs.html">docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_allocator/docs.html">pw_allocator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_assert/docs.html">pw_assert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_assert_basic/docs.html">pw_assert_basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_assert_log/docs.html">pw_assert_log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_base64/docs.html">pw_base64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_bloat/docs.html">pw_bloat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_blob_store/docs.html">pw_blob_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_boot_armv7m/docs.html">pw_boot_armv7m</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_build/docs.html">pw_build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_bytes/docs.html">pw_bytes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_checksum/docs.html">pw_checksum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_cli/docs.html">pw_cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_containers/docs.html">pw_containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_cpu_exception/docs.html">pw_cpu_exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_cpu_exception_armv7m/docs.html">pw_cpu_exception_armv7m</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pw_docgen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#documentation-overview">Documentation overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-integration">Build integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gn-templates">GN templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-documentation">Generating documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pw_doctor/docs.html">pw_doctor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_env_setup/docs.html">pw_env_setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_fuzzer/docs.html">pw_fuzzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_hdlc_lite/docs.html">pw_hdlc_lite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_hex_dump/docs.html">pw_hex_dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_kvs/docs.html">pw_kvs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_log/docs.html">pw_log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_log_basic/docs.html">pw_log_basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_log_null/docs.html">pw_log_null</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_log_tokenized/docs.html">pw_log_tokenized</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_metric/docs.html">pw_metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_minimal_cpp_stdlib/docs.html">pw_minimal_cpp_stdlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_module/docs.html">pw_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_polyfill/docs.html">pw_polyfill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_preprocessor/docs.html">pw_preprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_presubmit/docs.html">pw_presubmit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_protobuf/docs.html">pw_protobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_protobuf_compiler/docs.html">pw_protobuf_compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_random/docs.html">pw_random</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_result/docs.html">pw_result</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_ring_buffer/docs.html">pw_ring_buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_rpc/docs.html">pw_rpc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_span/docs.html">pw_span</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_status/docs.html">pw_status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_stream/docs.html">pw_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_string/docs.html">pw_string</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_sys_io/docs.html">pw_sys_io</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_sys_io_baremetal_stm32f429/docs.html">pw_sys_io_baremetal_stm32f429</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_sys_io_stdio/docs.html">pw_sys_io_stdio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_target_runner/docs.html">pw_target_runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_tokenizer/docs.html">pw_tokenizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_toolchain/docs.html">pw_toolchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_trace/docs.html">pw_trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_trace_tokenized/docs.html">pw_trace_tokenized</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_unit_test/docs.html">pw_unit_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_varint/docs.html">pw_varint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_watch/docs.html">pw_watch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pw_web_ui/docs.html">pw_web_ui</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pigweed</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../module_guides.html">Module Guides</a> &raquo;</li>
        
      <li>pw_docgen</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pw-docgen">
<span id="chapter-pw-docgen"></span><h1>pw_docgen<a class="headerlink" href="#pw-docgen" title="Permalink to this headline">¶</a></h1>
<p>The docgen module provides tools to generate documentation for Pigweed-based
projects, and for Pigweed itself.</p>
<p>Pigweed-based projects typically use a subset of Pigweed’s modules and add their
own product-specific modules on top of that, which may have product-specific
documentation. Docgen provides a convenient way to combine all of the relevant
documentation for a project into one place, allowing downstream consumers of
release bundles (e.g. factory teams, QA teams, beta testers, etc.) to have a
unified source of documentation early on.</p>
<p>The documentation generation is integrated directly into the build system. Any
build target can depend on documentation, which allows it to be included as part
of a factory release build, for example. Additionally, documentation itself can
depend on other build targets, such as report cards for binary size/profiling.
Any time the code is changed, documentation will be regenerated with the updated
reports.</p>
<div class="section" id="documentation-overview">
<h2>Documentation overview<a class="headerlink" href="#documentation-overview" title="Permalink to this headline">¶</a></h2>
<p>Each Pigweed module provides documentation describing its functionality, use
cases, and programming API.</p>
<p>Included in a module’s documentation are report cards which show an overview of
the module’s size cost and performance benchmarks. These allow prospective users
to evaluate the impact of including the module in their projects.</p>
</div>
<div class="section" id="build-integration">
<h2>Build integration<a class="headerlink" href="#build-integration" title="Permalink to this headline">¶</a></h2>
<p>Pigweed documentation files are written in <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> format and
rendered to HTML using <a class="reference external" href="http://www.sphinx-doc.org/en/master">Sphinx</a> through Pigweed’s GN build system.</p>
<p>Documentation source and asset files are placed alongside code within a module
and registered as a <code class="docutils literal notranslate"><span class="pre">pw_docgen_group</span></code> target within a <code class="docutils literal notranslate"><span class="pre">BUILD.gn</span></code> file. These
groups become available for import within a special documentation generation
target, which accumulates all of them and renders the resulting HTML. This
system can either be used directly within Pigweed, or integrated into a
downstream project.</p>
<div class="section" id="gn-templates">
<h3>GN templates<a class="headerlink" href="#gn-templates" title="Permalink to this headline">¶</a></h3>
<div class="section" id="pw-doc-group">
<h4>pw_doc_group<a class="headerlink" href="#pw-doc-group" title="Permalink to this headline">¶</a></h4>
<p>The main template for defining documentation files is <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code>. It is
used to logically group a collection of documentation source files and assets.
Each Pigweed module is expected to provide at least one <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code> target
defining the module’s documentation. A <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code> can depend on other
groups, causing them to be built with it.</p>
<p><strong>Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sources</span></code>: RST documentation source files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inputs</span></code>: Additional resources required for the docs (images, data files,
etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group_deps</span></code>: Other <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code> targets required by this one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">report_deps</span></code>: Report card generating targets (e.g. <code class="docutils literal notranslate"><span class="pre">pw_size_report</span></code>) on
which the docs depend.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pw_doc_group<span class="o">(</span><span class="s2">&quot;my_doc_group&quot;</span><span class="o">)</span> <span class="o">{</span>
  <span class="nv">sources</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;docs.rst&quot;</span> <span class="o">]</span>
  <span class="nv">inputs</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;face-with-tears-of-joy-emoji.svg&quot;</span> <span class="o">]</span>
  <span class="nv">group_deps</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;:sub_doc_group&quot;</span> <span class="o">]</span>
  <span class="nv">report_deps</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;:my_size_report&quot;</span> <span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="pw-doc-gen">
<h4>pw_doc_gen<a class="headerlink" href="#pw-doc-gen" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">pw_doc_gen</span></code> template creates a target which renders complete HTML
documentation for a project. It depends on registered <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code> targets
and creates an action which collects and renders them.</p>
<p>To generate the complete docs, the template also requires a <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file
configuring Sphinx’s output, and a top level <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> for the main page of
the documentation. These are added at the root level of the built documentation
to tie everything together.</p>
<p><strong>Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conf</span></code>: Path to the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> to use for Sphinx.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: Path to the top-level <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_directory</span></code>: Directory in which to render HTML output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deps</span></code>: List of all <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code> targets required for the documentation.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pw_doc_gen<span class="o">(</span><span class="s2">&quot;my_docs&quot;</span><span class="o">)</span> <span class="o">{</span>
  <span class="nv">conf</span> <span class="o">=</span> <span class="s2">&quot;//my_docs/conf.py&quot;</span>
  <span class="nv">index</span> <span class="o">=</span> <span class="s2">&quot;//my_docs/index.rst&quot;</span>
  <span class="nv">output_directory</span> <span class="o">=</span> target_gen_dir
  <span class="nv">deps</span> <span class="o">=</span> <span class="o">[</span>
    <span class="s2">&quot;//my_module:my_doc_group&quot;</span>,
  <span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="generating-documentation">
<h3>Generating documentation<a class="headerlink" href="#generating-documentation" title="Permalink to this headline">¶</a></h3>
<p>All source files listed under a <code class="docutils literal notranslate"><span class="pre">pw_doc_gen</span></code> target and its <code class="docutils literal notranslate"><span class="pre">pw_doc_group</span></code>
dependencies get copied out into a directory structure mirroring the original
layout of the modules in which the sources appear. This is demonstrated below
using a subset of Pigweed’s core documentation.</p>
<p>Consider the following target in <code class="docutils literal notranslate"><span class="pre">$dir_pigweed/docs/BUILD.gn</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pw_doc_gen<span class="o">(</span><span class="s2">&quot;docs&quot;</span><span class="o">)</span> <span class="o">{</span>
  <span class="nv">conf</span> <span class="o">=</span> <span class="s2">&quot;conf.py&quot;</span>
  <span class="nv">index</span> <span class="o">=</span> <span class="s2">&quot;index.rst&quot;</span>
  <span class="nv">output_directory</span> <span class="o">=</span> target_gen_dir
  <span class="nv">deps</span> <span class="o">=</span> <span class="o">[</span>
    <span class="s2">&quot;</span><span class="nv">$dir_pw_bloat</span><span class="s2">:docs&quot;</span>,
    <span class="s2">&quot;</span><span class="nv">$dir_pw_docgen</span><span class="s2">:docs&quot;</span>,
    <span class="s2">&quot;</span><span class="nv">$dir_pw_preprocessor</span><span class="s2">:docs&quot;</span>,
  <span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>A documentation tree is created under the output directory. Each of the sources
and inputs in the target’s dependency graph is copied under this tree in the
same directory structure as they appear under the root GN build directory
(<code class="docutils literal notranslate"><span class="pre">$dir_pigweed</span></code> in this case). The <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> and <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> provided
directly to the <code class="docutils literal notranslate"><span class="pre">pw_doc_gen</span></code> template are copied in at the root of the tree.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>out/gen/docs/pw_docgen_tree/
├── conf.py
├── index.rst
├── pw_bloat
│   ├── bloat.rst
│   └── examples
│       └── simple_bloat.rst
├── pw_docgen
│   └── docgen.rst
└── pw_preprocessor
    └── docs.rst
</pre></div>
</div>
<p>This is the documentation tree which gets passed to Sphinx to build HTML output.
Imports within documentation files must be relative to this structure. In
practice, relative imports from within modules’ documentation groups are
identical to the project’s directory structure. The only special case is the
top-level <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file’s imports; they must start from the project’s build
root.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pw_doctor/docs.html" class="btn btn-neutral float-right" title="pw_doctor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../pw_cpu_exception_armv7m/docs.html" class="btn btn-neutral float-left" title="pw_cpu_exception_armv7m" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020 The Pigweed Authors

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>